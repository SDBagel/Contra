@using Microsoft.AspNetCore.Identity
@using OpenTalon.Areas.Identity.Data
@inject UserManager<OpenTalonUser> UserManager

@{
    Layout = "/Views/Shared/_Layout.cshtml";
    OpenTalonUser user = UserManager.GetUserAsync(User).Result;
}

<section class="profile-dashboard">
    <div class="profile-controls">
        <div class="image-container">
            <img class="profile-picture" src="@(user.ProfilePictureURL + "&s=512")" />
            <div class="secondary-info">
                @if (!string.IsNullOrEmpty(user.ProfilePictureURL) && 
                      user.ProfilePictureURL.Contains("gravatar"))
                {
                    <a class="clickable" onclick="show">Change Picture</a>
                }
                else
                {
                    <a class="clickable" onclick="changePFP('@user.Id', 'reset')">Reset Picture</a>
                }
            </div>
        </div>
        <hr />
        <div>
            <h2>@user.Name</h2>
            <h5>Joined: @user.DateJoined.ToShortDateString()</h5>
            <br />
            <partial name="_ManageNav" />
        </div>
    </div>
    <div class="profile-page flex-big">
        @RenderBody()
    </div>
</section>

<div class="fullscreen query" id="dialog" onclick="hideDialog()">
    <div id="changePFP" class="align-content-center" onclick="stopPropogation(event)">
        <div class="card card-compact search shadow-none">
            <h2>Change profile picture</h2>
            <form action="~/create" method="post">
                <input type="text" id="serverName" name="Name" class="text-input" placeholder="Ex: Gamer Den 1337" />
                <button type="submit" class="btn btn-primary w-100">Create</button>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @RenderSection("Scripts", required: false)
}
